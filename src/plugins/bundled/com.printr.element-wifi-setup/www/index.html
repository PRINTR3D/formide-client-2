<!--
@Author: chris
@Date:   2017-01-06T14:32:08+01:00
@Filename: index.html
@Last modified by:   chris
@Last modified time: 2017-01-07T00:37:32+01:00
@Copyright: Copyright (c) 2016, All rights reserved, http://printr.nl
-->

<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>The Element - Setup</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The Element - Setup">
    <meta name="author" content="Printr">
    <link rel="stylesheet" href="/setup/assets/style.css">
  </head>
  <body>

    <main role="main" id="app">

      <div class="page-block">
        <div id="welcome" v-if="page === 'welcome'">
          <h1>Welcome</h1>
          <p>To set up your Element's Wi-Fi network and connect it to your Formide account, please follow these steps.</p>
          <hr />
          <a @click="goToPage('login')" class="button">Start Wi-Fi setup</a>
          <br/><br/>
          <p><a href="/">Go to local dashboard</a></p>
        </div>

        <div id="login" v-if="page === 'login'">
            <h1>Login</h1>
            <p>
              You need to login with your Element credentials before you can change the Wi-Fi settings.
              If you haven't created your own account yet, you can use the default credentials 'admin', 'admin@local'.
            </p>
            <form>
              <input type="text" name="email" placeholder="Enter your email..." v-model="loginForm.email" />
              <input type="password" name="password" placeholder="Enter your password..." v-model="loginForm.password" />
              <a @click="login()" class="button">Login</a>
              <p class="warning">{{ loginError }}</p>
            </form>
        </div>

        <div id="networks" v-if="page === 'networks'">
          <h1>Wi-Fi network</h1>
          <p>Select one of the networks from the list and enter your password. If you need more options, click 'advanced'.</p>
          <form>
              <div v-if="networks.length === 0">
                <span class="spinner"></span>
                <small>Searching for networks...</small>
              </div>

              <div v-if="connecting">
                <span class="spinner"></span>
                <small>Connecting to {{ connectForm.ssid }}...</small>
              </div>

              <div v-if="networks.length > 0 && !connecting">
                <select v-if="networks.length > 0" v-model="connectForm.ssid">
                  <option value="" disabled selected>Select your network...</option>
                  <option v-for="network in networks" v-bind:value="network.ssid">
                    {{ network.ssid }}
                  </option>
                </select>
                <input type="password" name="password" placeholder="Enter your password..." v-model="connectForm.password" />
                <a @click="connect()" class="button">Connect</a>
                <p class="warning">{{ connectError }}</p>

                <hr />
                <a @click="showAdvanced = !showAdvanced" class="link">
                  <span v-if="!showAdvanced">+</span>
                  <span v-if="showAdvanced">-</span>
                  Advanced
                </a>

                <div v-if="showAdvanced">
                  <br />
                  <input type="text" name="key_mgmt" placeholder="key_mgmt" v-model="connectForm.key_mgmt">
                  <input type="text" name="eap" placeholder="eap" v-model="connectForm.eap">
                  <input type="text" name="identity" placeholder="identity" v-model="connectForm.identity">
                  <input type="text" name="anonymous_identity" placeholder="anonymous_identity" v-model="connectForm.anonymous_identity">
                  <input type="text" name="phase1" placeholder="phase1 security" v-model="connectForm.phase1">
                  <input type="text" name="phase2" placeholder="phase2 security" v-model="connectForm.phase2">
                </div>
              </div>

          </form>
        </div>

        <div id="success" v-if="page === 'success'">
            <h1>Successfully connected</h1>
            <p>
              Your Element is now connected to <i>{{ connectForm.ssid }}</i>.
            </p>
            <p>
              You can access your Element via your local network on <i><a v-bind:href="ip">{{ ip }}</a></i>
              and connect it to Formide.com for cloud printing.
            </p>
            <br/>
            <a class="button" v-bind:href="ip">Go to Element login</a>
            <br/><br/>
            <p class="warning">Please connect to <i>{{ connectForm.ssid }}</i> before continuing.</p>
            <br/>
            <p><a href="/setup">Back to setup start</a></p>
        </div>
      </div>

    </main>

    <script src="/setup/assets/vue.js"></script>
    <script src="/setup/assets/vue-resource.min.js"></script>
    <script src="/setup/assets/app.js"></script>
  </body>
</html>
